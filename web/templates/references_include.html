{% autoescape off %}

    {% if references %}

        <div class="row-fluid">
            <div class="span2">
                <div class="well well-small">
                    <!-- sort -->
                    <div>
                        <p><h4>Search &amp; Filter</h4></p>
                        <div class="btn-group">
                            <a class="btn dropdown-toggle span12" data-toggle="dropdown" href="#" align="right">
                                Sort by
                                <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a href="{{ request.path }}?sort=authors">Author list</a></li>
                                <li><a href="{{ request.path }}?sort=year">Year</a></li>
                                <li><a href="{{ request.path }}?sort=journal">Journal</a></li>
                                <li><a href="{{ request.path }}?sort=title">Title</a></li>
                            </ul>
                        </div>
                        <!-- filter -->
                        <div style="padding-top:5px">
                            <br/><br/>

                            <form id="search" action="/search">
                                <input id="referencefilter" style="width:90%;" type="text" name="q"
                                       placeholder="Type to filter...">
                            </form>
                        </div>
                    </div>
                    <!-- note -->

                </div>

                <div style="padding-top:5px">
                        <a onclick="showSuggestBox('taxonomy')" class="btn">Suggest addition/correction</a>
                </div>


                <div style="padding-top:5px">
                    <a href="/taxonomy/{{ taxonomy.id}}/download" class="btn btn-inverse" style="width: 82%">Download Bibtex</a>
                </div>
            </div>

            <div class="span10">
                {% for reference in references %}
                    <div class="well taxonomy-well reference_box">
                        <p class="title">{{ reference.title }}</p>

                        <p class="authors">{{ reference.authors }}</p>

                        <p><span class="journal">{{ reference.journal }}</span>{% if reference.year > 0 %}
                            <span class="year">, {{ reference.year }}</span>{% endif %} </p>
                        <a onclick="showBibex({{ reference.bibtex }})" class="btn btn-small">Bibtex</a>
                    </div>
                {% endfor %}
            </div>
        </div>

        <script language="javascript">

            $(document).ready(function () {

                // filter functionality
                var rf_box = $('#referencefilter');

                $.extend($.expr[':'], {
                    'containsi': function (elem, i, match, array) {
                        return (elem.textContent || elem.innerText || '').toLowerCase()
                                .indexOf((match[3] || "").toLowerCase()) >= 0;
                    }
                });

                rf_box.keyup(function () {
                    if (rf_box.val().length > 0) {
                        $(".reference_box:not(:containsi('" + rf_box.val() + "'))").each(function () {
                            $(this).hide();
                        });
                        $(".reference_box:containsi('" + rf_box.val() + "')").each(function () {
                            $(this).show();
                        });
                    }
                    else {
                        $(".reference_box").show();
                    }
                });

            });

        </script>

    {% else %}

        There are no references.

    {% endif %}

{% endautoescape %}
